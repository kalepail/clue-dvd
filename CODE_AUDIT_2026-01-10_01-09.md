Code Audit Report - 2026-01-10 01:09

Scope
- Broad scan of all source files with deeper inspection of key UI, state, and scenario modules.
- No code changes made in this audit.

Primary Areas Reviewed
- Client UI: `src/client/pages/GamePage.tsx`, `src/client/components/AccusationPanel.tsx`, `src/client/components/SolutionCards.tsx`, `src/client/components/NewGameModal.tsx`, `src/client/styles.css`
- State/logic: `src/client/hooks/useGameStore.ts`
- Services: `src/services/scenario-generator.ts`, `src/services/campaign-planner.ts`, `src/services/campaign-clue-generator.ts`, `src/services/campaign-validator.ts`
- Data/shared: `src/data/game-elements.ts`, `src/shared/game-elements.ts`, `src/data/card-symbols.ts`
- Config: `vite.config.ts`

Findings (ordered by severity)

Medium
- Image mapping duplication and filename drift risk
  - The image ID maps are duplicated in multiple places (GamePage solution reveal, AccusationPanel, NewGameModal). This increases risk of mismatched filenames or typos.
  - Several filenames are misspelled or inconsistent with canonical names (e.g., `Scarab_Broach.png` vs “Brooch”, `Lady Lavendar.png` vs “Lavender”). It works now but is brittle and easy to break on rename.
  - Recommendation: centralize image ID maps into a shared module (e.g., `src/client/lib/card-images.ts`) and standardize filenames.

Medium
- Large icon assets for small UI slots
  - `public/images/Card Icon Assets/Magnifying_glass.svg.png` is 2048x2048 and is used at ~22px. This is heavy for a tiny icon.
  - Some SVGs keep large path data (800px viewBox), which is ok but could be simplified for performance.
  - Recommendation: downscale PNG icons or replace with smaller SVGs; consider using an optimized sprite or inline SVGs.

Low
- Unused or orphan assets
  - `public/images/Accusation screen.jpg` is not referenced in the codebase.
  - `tmp/` folder contains generated files and should be in `.gitignore`.
  - Recommendation: remove unused assets or move to a documented references folder; add `tmp/` to `.gitignore` if it’s not already there.

Low
- UI sizing uses many magic numbers
  - Example: symbol grid size (88x96), slot sizes, reveal image width percentages. This is fine but makes future tuning harder.
  - Recommendation: introduce CSS variables for key sizes (symbol grid size, image scale) to make tweaks more predictable.

Low
- Solution card symbol fetches are sequential
  - `SolutionCards` fetches card symbol data in a loop and sets state per card. This is functional but not optimal for render batching.
  - Recommendation: use `Promise.all` and update state once for fewer renders.

Notes / Context
- `vite.config.ts` sets `inspectorPort: false` for Cloudflare’s vite plugin to avoid local bind errors. Keep this in mind if you need inspector debugging later.
- The current reveal-card sizing uses custom CSS tuning documented in `UI_REVEAL_CARD_NOTES.md` for future adjustments.

Suggested Follow-Ups (when ready to act)
- Consolidate all image ID maps into a shared client module and normalize filenames.
- Add an asset lint/check (simple script) to verify all required card images exist and are named correctly.
- Add `.gitignore` for `tmp/` if it is temporary build output.
- Consider memoization or batching in `SolutionCards` data fetches.

